<div class="result-page-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Quiz Results</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- Overall Performance Summary -->
      <div class="overall-summary">
        <div class="summary-item">
          <h3>Total Score</h3>
          <p>{{ totalScore }} / {{ totalQuestions }}</p>
        </div>
        <div class="summary-item">
          <h3>Percentage</h3>
          <p>{{ percentage.toFixed(2) }}%</p>
        </div>
        <!-- Removed Time Taken field -->
      </div>

      <!-- Category-Wise Performance Table -->
      <table
        mat-table
        [dataSource]="dataSource"
        class="mat-elevation-z8 category-table"
      >
        <!-- Category Column -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef>Category</th>
          <td mat-cell *matCellDef="let element">{{ element.category }}</td>
        </ng-container>

        <!-- Questions Attempted Column -->
        <ng-container matColumnDef="attempted">
          <th mat-header-cell *matHeaderCellDef>Questions Attempted</th>
          <td mat-cell *matCellDef="let element">{{ element.attempted }}</td>
        </ng-container>

        <!-- Correct Answers Column -->
        <ng-container matColumnDef="correct">
          <th mat-header-cell *matHeaderCellDef>Correct Answers</th>
          <td mat-cell *matCellDef="let element">{{ element.correctAnswers }}</td>
        </ng-container>

        <!-- Score Column -->
        <ng-container matColumnDef="score">
          <th mat-header-cell *matHeaderCellDef>Score</th>
          <td mat-cell *matCellDef="let element">{{ element.score }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <div class="buttons-container">
        <button mat-raised-button color="primary" (click)="downloadTable()">
          Download
        </button>
        <button mat-raised-button color="accent" (click)="printTable()">
          Print
        </button>
      </div>

      <!-- Graphical Representation (Pie Chart) -->
      <div class="graph-section">
        <h3>Performance Overview</h3>
        <!-- Pie Chart -->
        <div style="display: block">
          <canvas
            baseChart
            [data]="pieChartData"
            [labels]="pieChartLabels"
            [type]="pieChartType"
            [options]="pieChartOptions"
            [legend]="pieChartLegend"
          >
          </canvas>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button
          routerLink="/view-detail-answer"
          mat-raised-button
          color="accent"
        >
          View Detailed Answers
        </button>
        <button routerLink="/dashboard" mat-raised-button color="warn">
          Return to Dashboard
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
